#Notes: Added line edit boxes for X, Y, and Z for Rotation of Scatter Objects. Not sure how to fix sliders or make it appear as I want it to.

import logging

from PySide2 import QtWidgets, QtCore
from shiboken2 import wrapInstance
import maya.OpenMayaUI as omui
import maya.cmds as cmds
import pymel.core as pmc
from pymel.core.system import Path

log = logging.getLogger(__name__)

polygon_base_chosen = int(0)
polygon_scatter_chosen = int(0)


def maya_main_window():
    """Return the maya main window widget"""
    main_window = omui.MQtUtil.mainWindow()
    return wrapInstance(long(main_window), QtWidgets.QWidget)


class ScatterToolGUI(QtWidgets.QDialog):
    """Scatter Tool GUI Class"""
    def __init__(self):
        """Constructor"""
        super(ScatterToolGUI, self).__init__(parent=maya_main_window())
        self.setWindowTitle("Scatter Tool")
        self.setMinimumWidth(500)
        self.setMaximumHeight(200)
        self.setWindowFlags(self.windowFlags() ^
                            QtCore.Qt.WindowContextHelpButtonHint)
        self.create_ui()
        self.create_connections()

    """Creates UI Layout"""
    def create_ui(self):
        """Title labels"""
        self.title_lbl = QtWidgets.QLabel("Scatter Tool")
        self.title_lbl.setStyleSheet("font: bold 20px")
        """Polygon base"""
        self.polygon_base_lbl = QtWidgets.QLabel("Select Polygon object for"
                                                 " the base")
        self.polygon_base_lay = self._create_polygon_base_ui()
        """Polygon scatter"""
        self.polygon_scatter_lbl = QtWidgets.QLabel("Select Polygon to Scatter"
                                                    " on base")
        self.polygon_scatter_lay = self._create_polygon_scatter_ui()
        """Density"""
        self.density_lbl = QtWidgets.QLabel("Density")
        self.density_lay = self._create_density_ui()
        """Scale"""
        self.scale_lbl = QtWidgets.QLabel("Scale")
        """Rotation"""
        self.rotation_lbl = QtWidgets.QLabel("Rotation")
        self.rotation_lay = self._create_rotation_ui()
        """Additional Feature"""

        """Layout for buttons"""
        self.button_lay = self._create_button_ui()
        """Main layout for main window"""
        self.main_lay = QtWidgets.QVBoxLayout()
        self.main_lay.addWidget(self.title_lbl)
        """Polygon base added to window"""
        self.main_lay.addWidget(self.polygon_base_lbl)
        self.main_lay.addLayout(self.polygon_base_lay)
        """Polygon Scatter added to window"""
        self.main_lay.addWidget(self.polygon_scatter_lbl)
        self.main_lay.addLayout(self.polygon_scatter_lay)
        """Density scroll bar added to window"""
        self.main_lay.addWidget(self.density_lbl)
        self.main_lay.addLayout(self.density_lay)
        """Scale scroll bar added to window"""
        self.main_lay.addWidget(self.scale_lbl)
        """Rotation added to window"""
        self.main_lay.addWidget(self.rotation_lbl)
        self.main_lay.addLayout(self.rotation_lay)
        """Adds stretch to window"""
        self.main_lay.addStretch()
        self.main_lay.addLayout(self.button_lay)
        self.setLayout(self.main_lay)

    """Creates polygon base layout"""
    def _create_polygon_base_ui(self):
        """self.polygon_base_le = QtWidgets.QLineEdit()"""
        self.polygon_base_combobox = QtWidgets.QComboBox()
        self.polygon_base_combobox.addItems(["Sphere", "Cube", "Cylinder",
                                             "Cone", "Torus", "Plane"])
        layout = QtWidgets.QHBoxLayout()
        """layout.addWidget(self.polygon_base_le)"""
        layout.addWidget(self.polygon_base_combobox)
        return layout

    def _create_polygon_scatter_ui(self):
        self.polygon_scatter_combobox = QtWidgets.QComboBox()
        self.polygon_scatter_combobox.addItems(["Sphere", "Cube", "Cylinder",
                                                "Cone", "Torus", "Plane"])
        layout = QtWidgets.QHBoxLayout()
        layout.addWidget(self.polygon_scatter_combobox)
        return layout

    def _create_density_ui(self):
        self.density_slider = QtWidgets.QSlider()
        self.density_slider.setTickInterval(10)
        self.density_slider.setMinimum(0)
        self.density_slider.setMaximum(100)
        layout = QtWidgets.QVBoxLayout()
        layout.addWidget(self.density_slider)
        return layout

    def _create_rotation_ui(self):
        self.x_box_le = QtWidgets.QLineEdit('1')
        self.x_box_le.setFixedWidth(30)
        self.y_box_le = QtWidgets.QLineEdit('1')
        self.y_box_le.setFixedWidth(30)
        self.z_box_le = QtWidgets.QLineEdit('1')
        self.z_box_le.setFixedWidth(30)
        self.rotation_spacer = QtWidgets.QLabel(' ')
        layout = QtWidgets.QGridLayout()
        layout.addWidget(QtWidgets.QLabel("X"), 1, 0)
        layout.addWidget(self.x_box_le, 1, 1)
        layout.addWidget(QtWidgets.QLabel("Y"), 1, 2)
        layout.addWidget(self.y_box_le, 1, 3)
        layout.addWidget(QtWidgets.QLabel("Z"), 1, 4)
        layout.addWidget(self.z_box_le, 1, 5)
        layout.addWidget(self.rotation_spacer, 1, 6)
        layout.addWidget(self.rotation_spacer, 1, 7)
        layout.addWidget(self.rotation_spacer, 1, 8)
        layout.addWidget(self.rotation_spacer, 1, 9)
        layout.addWidget(self.rotation_spacer, 1, 10)
        layout.addWidget(self.rotation_spacer, 1, 11)
        return layout

    def create_connections(self):
        self.polygon_base_combobox.currentIndexChanged.\
            connect(self._spawn_polygon_base)
        self.polygon_scatter_combobox.currentIndexChanged.\
            connect(self._spawn_polygon_scatter)

    """Creates a polygon_base based on item chosen in combo boxes"""
    """and selects and deletes all other polygon_base that weren't chosen"""
    def _spawn_polygon_base(self):
        if polygon_base_chosen == 0:
            if self.polygon_base_combobox.currentText() == "Cube":
                cmds.polyCube(n='cube_base')
                if cmds.objExists('sphere_base'):
                    cmds.select('sphere_base')
                    cmds.delete('sphere_base')
                if cmds.objExists('cylinder_base'):
                    cmds.select('cylinder_base')
                    cmds.delete('cylinder_base')
                if cmds.objExists('cone_base'):
                    cmds.select('cone_base')
                    cmds.delete('cone_base')
                if cmds.objExists('torus_base'):
                    cmds.select('torus_base')
                    cmds.delete('torus_base')
                if cmds.objExists('plane_base'):
                    cmds.select('plane_base')
                    cmds.delete('plane_base')
            if self.polygon_base_combobox.currentText() == "Sphere":
                cmds.polySphere(n='sphere_base')
                if cmds.objExists('cube_base'):
                    cmds.select('cube_base')
                    cmds.delete('cube_base')
                if cmds.objExists('cylinder_base'):
                    cmds.select('cylinder_base')
                    cmds.delete('cylinder_base')
                if cmds.objExists('cone_base'):
                    cmds.select('cone_base')
                    cmds.delete('cone_base')
                if cmds.objExists('torus_base'):
                    cmds.select('torus_base')
                    cmds.delete('torus_base')
                if cmds.objExists('plane_base'):
                    cmds.select('plane_base')
                    cmds.delete('plane_base')
            if self.polygon_base_combobox.currentText() == "Cylinder":
                cmds.polyCylinder(n='cylinder_base')
                if cmds.objExists('cube_base'):
                    cmds.select('cube_base')
                    cmds.delete('cube_base')
                if cmds.objExists('sphere_base'):
                    cmds.select('sphere_base')
                    cmds.delete('sphere_base')
                if cmds.objExists('cone_base'):
                    cmds.select('cone_base')
                    cmds.delete('cone_base')
                if cmds.objExists('torus_base'):
                    cmds.select('torus_base')
                    cmds.delete('torus_base')
                if cmds.objExists('plane_base'):
                    cmds.select('plane_base')
                    cmds.delete('plane_base')
            if self.polygon_base_combobox.currentText() == "Cone":
                cmds.polyCone(n='cone_base')
                if cmds.objExists('cube_base'):
                    cmds.select('cube_base')
                    cmds.delete('cube_base')
                if cmds.objExists('sphere_base'):
                    cmds.select('sphere_base')
                    cmds.delete('sphere_base')
                if cmds.objExists('cylinder_base'):
                    cmds.select('cylinder_base')
                    cmds.delete('cylinder_base')
                if cmds.objExists('torus_base'):
                    cmds.select('torus_base')
                    cmds.delete('torus_base')
                if cmds.objExists('plane_base'):
                    cmds.select('plane_base')
                    cmds.delete('plane_base')
            if self.polygon_base_combobox.currentText() == "Torus":
                cmds.polyTorus(n='torus_base')
                if cmds.objExists('cube_base'):
                    cmds.select('cube_base')
                    cmds.delete('cube_base')
                if cmds.objExists('sphere_base'):
                    cmds.select('sphere_base')
                    cmds.delete('sphere_base')
                if cmds.objExists('cylinder_base'):
                    cmds.select('cylinder_base')
                    cmds.delete('cylinder_base')
                if cmds.objExists('cone_base'):
                    cmds.select('cone_base')
                    cmds.delete('cone_base')
                if cmds.objExists('plane_base'):
                    cmds.select('plane_base')
                    cmds.delete('plane_base')
            if self.polygon_base_combobox.currentText() == "Plane":
                cmds.polyPlane(n='plane_base')
                if cmds.objExists('cube_base'):
                    cmds.select('cube_base')
                    cmds.delete('cube_base')
                if cmds.objExists('sphere_base'):
                    cmds.select('sphere_base')
                    cmds.delete('sphere_base')
                if cmds.objExists('cylinder_base'):
                    cmds.select('cylinder_base')
                    cmds.delete('cylinder_base')
                if cmds.objExists('cone_base'):
                    cmds.select('cone_base')
                    cmds.delete('cone_base')
                if cmds.objExists('torus_base'):
                    cmds.select('torus_base')
                    cmds.delete('torus_base')

    def _spawn_polygon_scatter(self):
        if polygon_scatter_chosen == 0:
            if self.polygon_scatter_combobox.currentText() == "Cube":
                cmds.polyCube(n='cube_scatter')
                if cmds.objExists('sphere_scatter'):
                    cmds.select('sphere_scatter')
                    cmds.delete('sphere_scatter')
                if cmds.objExists('cylinder_scatter'):
                    cmds.select('cylinder_scatter')
                    cmds.delete('cylinder_scatter')
                if cmds.objExists('cone_scatter'):
                    cmds.select('cone_scatter')
                    cmds.delete('cone_scatter')
                if cmds.objExists('torus_scatter'):
                    cmds.select('torus_scatter')
                    cmds.delete('torus_scatter')
                if cmds.objExists('plane_scatter'):
                    cmds.select('plane_scatter')
                    cmds.delete('plane_scatter')
            if self.polygon_scatter_combobox.currentText() == "Sphere":
                cmds.polySphere(n='sphere_scatter')
                if cmds.objExists('cube_scatter'):
                    cmds.select('cube_scatter')
                    cmds.delete('cube_scatter')
                if cmds.objExists('cylinder_scatter'):
                    cmds.select('cylinder_scatter')
                    cmds.delete('cylinder_scatter')
                if cmds.objExists('cone_scatter'):
                    cmds.select('cone_scatter')
                    cmds.delete('cone_scatter')
                if cmds.objExists('torus_scatter'):
                    cmds.select('torus_scatter')
                    cmds.delete('torus_scatter')
                if cmds.objExists('plane_scatter'):
                    cmds.select('plane_scatter')
                    cmds.delete('plane_scatter')
            if self.polygon_scatter_combobox.currentText() == "Cylinder":
                cmds.polyCylinder(n='cylinder_scatter')
                if cmds.objExists('cube_scatter'):
                    cmds.select('cube_scatter')
                    cmds.delete('cube_scatter')
                if cmds.objExists('sphere_scatter'):
                    cmds.select('sphere_scatter')
                    cmds.delete('sphere_scatter')
                if cmds.objExists('cone_scatter'):
                    cmds.select('cone_scatter')
                    cmds.delete('cone_scatter')
                if cmds.objExists('torus_scatter'):
                    cmds.select('torus_scatter')
                    cmds.delete('torus_scatter')
                if cmds.objExists('plane_scatter'):
                    cmds.select('plane_scatter')
                    cmds.delete('plane_scatter')
            if self.polygon_scatter_combobox.currentText() == "Cone":
                cmds.polyCone(n='cone_scatter')
                if cmds.objExists('cube_scatter'):
                    cmds.select('cube_scatter')
                    cmds.delete('cube_scatter')
                if cmds.objExists('sphere_scatter'):
                    cmds.select('sphere_scatter')
                    cmds.delete('sphere_scatter')
                if cmds.objExists('cylinder_scatter'):
                    cmds.select('cylinder_scatter')
                    cmds.delete('cylinder_scatter')
                if cmds.objExists('torus_scatter'):
                    cmds.select('torus_scatter')
                    cmds.delete('torus_scatter')
                if cmds.objExists('plane_scatter'):
                    cmds.select('plane_scatter')
                    cmds.delete('plane_scatter')
            if self.polygon_scatter_combobox.currentText() == "Torus":
                cmds.polyTorus(n='torus_scatter')
                if cmds.objExists('cube_scatter'):
                    cmds.select('cube_scatter')
                    cmds.delete('cube_scatter')
                if cmds.objExists('sphere_scatter'):
                    cmds.select('sphere_scatter')
                    cmds.delete('sphere_scatter')
                if cmds.objExists('cylinder_scatter'):
                    cmds.select('cylinder_scatter')
                    cmds.delete('cylinder_scatter')
                if cmds.objExists('cone_scatter'):
                    cmds.select('cone_scatter')
                    cmds.delete('cone_scatter')
                if cmds.objExists('plane_scatter'):
                    cmds.select('plane_scatter')
                    cmds.delete('plane_scatter')
            if self.polygon_scatter_combobox.currentText() == "Plane":
                cmds.polyPlane(n='plane_scatter')
                if cmds.objExists('cube_scatter'):
                    cmds.select('cube_scatter')
                    cmds.delete('cube_scatter')
                if cmds.objExists('sphere_scatter'):
                    cmds.select('sphere_scatter')
                    cmds.delete('sphere_scatter')
                if cmds.objExists('cylinder_scatter'):
                    cmds.select('cylinder_scatter')
                    cmds.delete('cylinder_scatter')
                if cmds.objExists('cone_scatter'):
                    cmds.select('cone_scatter')
                    cmds.delete('cone_scatter')
                if cmds.objExists('torus_scatter'):
                    cmds.select('torus_scatter')
                    cmds.delete('torus_scatter')

    """Creates button layout"""
    def _create_button_ui(self):
        self.save_btn = QtWidgets.QPushButton("Save")
        self.save_increment_btn = QtWidgets.QPushButton("Save Increment")
        layout = QtWidgets.QHBoxLayout()
        layout.addWidget(self.save_btn)
        layout.addWidget(self.save_increment_btn)
        return layout


class ScatterTool(object):
    """Code for Scatter Tool."""
